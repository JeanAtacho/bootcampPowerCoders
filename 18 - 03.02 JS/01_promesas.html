<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Promesas</title>
</head>
<body>
    
    <script>
        // Pendiente | Rechazado | Resuelta

/* PRIMERA FORMA DE ESCRIBIRLO
        const promesa = new Promise((resolver, rechazar) => {
            setTimeout(() => {
                resolver({ id: 1, firstName: 'Juan', lastName: 'Perez', age: 25 })
            }, 2000)
        })

        promesa
            .then(respuesta => console.log(respuesta)) // cuando la promesa esta respondida correctamente.
            .catch() // Dice que es lo que pasa cuando la promesa ha sido rechazada.
            .finally() // Sirve para ambos casos anteriores.
*/
/* SEGUNDA FORMA DE ESCRIBIRLO Y OBTENER EL MISMO RESULTADO
    function getUser(time) {
        const promesa = new Promise((resolver, rechazar) => {
            setTimeout(() => {
                resolver({ 
                    id: 1, 
                    firstName: 'Juan', 
                    lastName: 'Perez', 
                    age: 25 })
            }, time)
        })

        return promesa
    }

    getUser(1000)
        .then(respuesta => console.log(respuesta))
        .catch()
        .finally()
*/

/* MODO DE COMO VER EL ERROR CON EL .CATCH
function getUser(time) {
        const promesa = new Promise((resolver, rechazar) => {
            if (time < 0) {
                rechazar('Aun no se ha creado la maquina del tiempo')
            }
            setTimeout(() => {
                resolver({ 
                    id: 1, 
                    firstName: 'Juan', 
                    lastName: 'Perez', 
                    age: 25 })
            }, time)
        })

        return promesa
    }

    getUser(-1000)
        .then(respuesta => console.log(respuesta))
        .catch(error => console.error(error))
        .finally()
*/

/*
//MODO DE COMO VER EL ERROR CON EL .CATCH
function getUser(time) {
        const promesa = new Promise((resolver, rechazar) => {
            if (time < 0) {
                rechazar('Aun no se ha creado la maquina del tiempo')
            }
            setTimeout(() => {
                resolver({ 
                    id: 1, 
                    firstName: 'Juan', 
                    lastName: 'Perez', 
                    age: 25 })
            }, time)
        })

        return promesa
    }

    getUser(-1000)
        .then(respuesta => console.log(respuesta))
        .catch(error => console.error(error))
        .finally(text => console.warn('Esto se ejecuta una vez que la anterior ha sido respondida'))

*/
    //JSON = Javascript Object Notation
    // Ejemplo de escritura de un archivo JSON:
    /*    const json = {
            "id": 1, 
            "firstName": 'Juan', 
            "lastName": 'Perez', 
            "age": '25'
        }
    */

    // PARA TRABAJAR CON JSON
    function getUser(time) {
        const json = JSON.stringify({
            id: 1, 
            firstName: 'Juan', 
            lastName: 'Perez', 
            age: 25
        })
        const promesa = new Promise((resolver, rechazar) => {
            if (time < 0) {
                rechazar('Aun no se ha creado la maquina del tiempo')
            }

            console.log(json)

            setTimeout(() => {
                resolver(json)
            }, time)
        })

        return promesa
    }

    getUser(1000)
        .then(data => JSON.parse(data))
        .then(respuesta => console.log(respuesta))
        .catch(error => console.error(error))
        .finally(text => console.warn('Esto se ejecuta una vez que la anterior ha sido respondida'))

    </script>
</body>
</html>